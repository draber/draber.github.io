!function(){"use strict";const t=({tag:e="div",text:s="",attributes:a={},style:i={},data:r={},events:n={},classNames:o=[],cellData:l=[],cellTag:c="td",checked:d=!1}={})=>{if("tr"===e&&l.length)return(({classNames:e=[],events:s={},cellData:a=[],cellTag:i="td"}={})=>{const r=t({tag:"tr",classNames:e,events:s});return a.forEach((e=>{r.append(t({tag:i,text:e}))})),r})({classNames:o,events:n,cellData:l,cellTag:c});if("input"===e&&"checkbox"===a.type&&s)return(({text:e="",classNames:s=[],attributes:a={},events:i={},checked:r=!1}={})=>{r&&(a.checked="checked");const n=t({tag:"input",attributes:a,events:i}),o=t({tag:"label",text:e,classNames:s});return o.prepend(n),o})({text:s,classNames:o,attributes:a,events:n,checked:d});const p=document.createElement(e);for(const[t,e]of Object.entries(i))p.style[t]=e;o.length&&p.classList.add(...o),Array.isArray(s)?p.append(t({tag:s[1],text:s[0]})):p.textContent=s;for(const[t,e]of Object.entries(a))""!==e&&p.setAttribute(t,e);for(const[t,e]of Object.entries(r))p.dataset[t]=e;for(const[t,e]of Object.entries(n))p.addEventListener(t,e,!1);return p};var e={$:(t,e=null)=>"string"==typeof t?(e||document).querySelector(t):t||null,$$:(t,e=null)=>[].slice.call((e||document).querySelectorAll(t)),create:t},s="sba";const a={label:"Spelling Bee Assistant",title:"Assistant",url:"https://spelling-bee-assistant.app/",prefix:s,repo:"draber/draber.github.io.git",targetUrl:"https://www.nytimes.com/puzzles/spelling-bee",version:"2.0.0",options:JSON.parse(localStorage.getItem("sba-settings")||"{}")};var i=t=>{let e=Object.create(a);for(let s of t.split(".")){if(!e[s])return;e=e[s]}return e},r=(t,e)=>{const s=t.split("."),i=s.pop();let r=a;for(let t of s){if(r[t]||(r[t]={}),"[object Object]"===!Object.prototype.toString.call(r))return console.error(`${t} is not of the type Object`),!1;r=r[t]}r[i]=e,localStorage.setItem("sba-settings",JSON.stringify(a.options))};const n=i("prefix"),o=t=>t.replace(/[_-]+/," ").replace(/(?:^[\w]|[A-Z]|\b\w|\s+)/g,(function(t,e){return 0==+t?"":0===e?t.toLowerCase():t.toUpperCase()})),l=(t,e="c")=>{switch(e){case"c":return o(n+"_"+t);case"d":return(t=>t.replace(/[\W_]+/g," ").split(/ |\B(?=[A-Z])/).map((t=>t.toLowerCase())).join("-"))(n+t.charAt(0).toUpperCase()+t.slice(1));default:return n+t}};let c;const d=(t,s)=>{c.foundTerms=[],c.foundPangrams=[],e.$$("li",s).forEach((t=>{const e=t.textContent;c.foundTerms.push(e),c.pangrams.includes(e)&&(c.foundPangrams.push(e),t.classList.add("sb-pangram"))})),c.remainders=c.answers.filter((t=>!c.foundTerms.includes(t))),t.on(new Event(l("updateComplete")))};var p=(t,e)=>{c={answers:window.gameData.today.answers,pangrams:window.gameData.today.pangrams,foundTerms:[],foundPangrams:[],remainders:[]},d(t,e),t.on(l("update"),(()=>{d(t,e)}))},h=t=>c[t],g=t=>c[t].length,u=t=>{const e=c[t];let s=0;return e.forEach((t=>{c.pangrams.includes(t)?s+=t.length+7:t.length>4?s+=t.length:s+=1})),s};class b{constructor(t){this.app=t,this.defaultEnabled=!0,this.optional=!1,this.title="",this.ui,this.target,this.hasUi=()=>this.ui instanceof HTMLElement,this.isEnabled=()=>{const t=i(`options.${this.key}`);return void 0!==t?t:this.defaultEnabled},this.toggle=t=>{r(`options.${this.key}`,t),this.ui.classList.toggle("inactive",!t)},this.attach=()=>{if(!this.hasUi())return!1;return(this.target||e.$(`[data-ui="${this.key}"]`,t.ui)||(()=>{const s=e.create({data:{plugin:this.key}});return t.ui.append(s),s})()).append(this.ui),!0},this.add=()=>{this.attach(),this.optional&&r(`options.${this.key}`,this.isEnabled())}}}const m=t=>{t.innerHTML="",[["Words",g("foundTerms"),g("remainders"),g("answers")],["Points",u("foundTerms"),u("remainders"),u("answers")]].forEach((s=>{t.append(e.create({tag:"tr",cellData:s}))}))};var f={styles:class extends b{constructor(t){super(t),this.app=t,this.title="Styles",this.key=o(this.title),this.target=e.$("head"),this.ui=e.create({tag:"style",text:'\ufeff.pz-game-field{background:inherit;color:inherit}.sb-wordlist-items .sb-pangram{border-bottom:2px #f8cd05 solid}.sb-wordlist-items .sb-anagram a{color:#888}.sba-dark{background:#111;color:#eee}.sba-dark .sba{background:#111}.sba-dark .sba summary{background:#252525;color:#eee}.sba-dark .pz-nav__hamburger-inner,.sba-dark .pz-nav__hamburger-inner::before,.sba-dark .pz-nav__hamburger-inner::after{background-color:#eee}.sba-dark .pz-nav{width:100%;background:#111}.sba-dark .pz-nav__logo{filter:invert(1)}.sba-dark .sb-modal-scrim{background:rgba(17,17,17,.85);color:#eee}.sba-dark .pz-modal__title{color:#eee}.sba-dark .sb-modal-frame,.sba-dark .pz-modal__button.white{background:#111;color:#eee}.sba-dark .pz-modal__button.white:hover{background:#393939}.sba-dark .sb-message{background:#393939}.sba-dark .sb-progress-marker .sb-progress-value,.sba-dark .hive-cell.center .cell-fill{background:#f7c60a;fill:#f7c60a;color:#111}.sba-dark .sb-input-bright{color:#f7c60a}.sba-dark .hive-cell.outer .cell-fill{fill:#393939}.sba-dark .cell-fill{stroke:#111}.sba-dark .cell-letter{fill:#eee}.sba-dark .hive-cell.center .cell-letter{fill:#111}.sba-dark .hive-action:not(.hive-action__shuffle){background:#111;color:#eee}.sba-dark .hive-action__shuffle{filter:invert(100%)}.sba-dark *:not(.hive-action__shuffle):not(.sb-pangram):not(.sba-current){border-color:#333 !important}.sba{position:absolute;width:200px;background:inherit;box-sizing:border-box;z-index:3;margin:16px 0;padding:0 10px 5px;background:#fff;border-width:1px;border-color:#dcdcdc;border-radius:6px;border-style:solid}.sba *,.sba *:before,.sba *:after{box-sizing:border-box}.sba *:focus{outline:0}.sba .dragger{font-weight:bold;cursor:move;line-height:32px}.sba .closer,.sba .minimizer{font-size:18px;font-weight:bold;position:absolute;top:0;line-height:32px;padding:0 10px;cursor:pointer}.sba .closer{right:0}.sba .minimizer{right:16px;transform:rotate(-90deg);transform-origin:center;font-size:10px;right:24px;top:1px}.sba .minimizer:before{content:"â¯"}.sba.minimized details{display:none}.sba.minimized .minimizer{transform:rotate(90deg);right:25px;top:0}.sba details{font-size:90%;margin-bottom:1px;max-height:800px;transition:max-height .25s ease-in}.sba details[open] summary:before{transform:rotate(-90deg);left:12px;top:0}.sba details.inactive{height:0;max-height:0;transition:max-height .25s ease-out;overflow:hidden;margin:0}.sba summary{line-height:24px;padding:0 15px 0 25px;background:#f8cd05;cursor:pointer;list-style:none;position:relative}.sba summary::-webkit-details-marker{display:none}.sba summary:before{content:"â¯";font-size:9px;position:absolute;display:inline-block;transform:rotate(90deg);transform-origin:center;left:9px;top:-1px}.sba .hive-action{margin:0 auto;display:block;font-size:100%;white-space:nowrap}.sba .pane{border:1px solid #dcdcdc;border-top:none;border-collapse:collapse;width:100%;font-size:85%;margin-bottom:4px}.sba tr:first-of-type td,.sba tr:first-of-type th{border-top:none}.sba tr td:first-of-type{text-align:left}.sba tr.sba-current{font-weight:bold;border-bottom:2px solid #f8cd05 !important}.sba th,.sba td{border:1px solid #dcdcdc;white-space:nowrap}.sba thead th{text-align:center;padding:4px 0}.sba tbody th{text-align:right}.sba tbody td{text-align:center;padding:4px 6px}.sba [data-plugin=footer] a{color:currentColor;opacity:.6;font-size:10px;text-align:right;display:block;padding-top:8px}.sba [data-plugin=footer] a:hover{opacity:.8;text-decoration:underline}.sba .spill-title{padding:10px 6px 0px;text-align:center}.sba .spill{text-align:center;padding:17px 0;font-size:280%}.sba ul.pane{padding:5px}.sba [data-plugin=surrender] .pane{padding:10px 5px}.sba label{cursor:pointer;position:relative;line-height:19px}.sba label input{position:relative;top:2px;margin:0 10px 0 0}\n'.replace(/(\uFEFF|\\n)/gu,"")}),t.on(l("destroy"),(()=>{this.ui.remove()})),this.add()}},darkMode:class extends b{constructor(t){super(t),this.title="Dark Mode",this.key=o(this.title),this.optional=!0,this.defaultEnabled=!1;const s=l("dark","d");this.toggle=t=>{r(`options.${this.key}`,t),e.$("body").classList.toggle(s,t)},this.toggle(this.isEnabled()),this.add()}},header:class extends b{constructor(t){let s;super(t),this.title=i("title"),this.key="header",this.ui=e.create();let a=!1;const r=e=>{const s=t.game.getBoundingClientRect(),a=e.target.getBoundingClientRect(),i=s.top+window.pageYOffset,r=this.ui.parentElement.getBoundingClientRect(),n=s.height-(s.top-a.top)-(a.top-r.top)-r.height;return{maxL:document.documentElement.clientWidth-a.width,minT:i,maxT:i+n,offX:e.clientX-a.x,offY:e.clientY-a.y,margT:parseInt(getComputedStyle(e.target).marginTop,10)}};this.ui.append(e.create({text:this.title,attributes:{title:"Hold the mouse down to drag"},classNames:["dragger"]})),this.ui.append(e.create({tag:"span",text:"Ã—",attributes:{title:"Close"},classNames:["closer"],events:{click:()=>{t.trigger(new Event(l("destroy")))}}})),this.ui.append(e.create({tag:"span",attributes:{title:"Minimize"},classNames:["minimizer"],events:{click:()=>{t.ui.classList.toggle("minimized")}}})),t.on("pointerdown",(t=>{a=!!t.target.closest(`[data-plugin="${this.key}"]`)})),t.on("pointerup",(()=>{a=!1})),[t.ui,t.game].forEach((t=>{t.addEventListener("dragover",(t=>{t.preventDefault()}))})),t.on("dragstart",(t=>{if(!a)return t.preventDefault(),!1;t.target.style.opacity=".2",s=r(t)}),!1),t.on("dragend",(t=>{Object.assign(t.target.style,(t=>{let e=Math.max(0,t.clientX-s.offX);e=Math.min(e,s.maxL)+"px";let a=Math.max(s.minT,t.clientY+window.pageYOffset-s.margT-s.offY);return a=Math.min(a,s.maxT)+"px",{left:e,top:a}})(t)),t.target.style.opacity="1"})),this.add()}},scoreSoFar:class extends b{constructor(t){super(t),this.title="Score so far",this.key=o(this.title),this.optional=!0,this.ui=e.create({tag:"details",text:[this.title,"summary"],attributes:{open:!0},classNames:this.isEnabled?[]:["inactive"]});const s=e.create({tag:"table",classNames:["pane"]}),a=e.create({tag:"thead"});a.append(e.create({tag:"tr",cellTag:"th",cellData:["","Found","Missing","Total"]}));const i=e.create({tag:"tbody"});s.append(a),s.append(i),m(i),this.ui.append(s),t.on(l("updateComplete"),(()=>{m(i)})),this.add()}},spoilers:class extends b{constructor(t){super(t),this.title="Spoilers",this.key=o(this.title),this.optional=!0;const s=e.create({tag:"tbody"}),a=()=>{s.innerHTML="",(()=>{const t={},e=g("pangrams"),s=g("foundPangrams"),a=[["Pangrams",s,e-s,e]];h("answers").forEach((e=>{t[e.length]=t[e.length]||{found:0,missing:0,total:0},h("foundTerms").includes(e)?t[e.length].found++:t[e.length].missing++,t[e.length].total++}));let i=Object.keys(t);return i.sort(((t,e)=>t-e)),i.forEach((e=>{a.push([e+" "+(e>1?"letters":"letter"),t[e].found,t[e].missing,t[e].total])})),a})().forEach((t=>{s.append(e.create({tag:"tr",cellData:t}))}))};this.ui=e.create({tag:"details",text:[this.title,"summary"],classNames:this.isEnabled?[]:["inactive"]});const i=e.create({tag:"table",classNames:["pane"]}),r=e.create({tag:"thead"});r.append(e.create({tag:"tr",cellTag:"th",cellData:["","Found","Missing","Total"]})),i.append(r),i.append(s),a(),this.ui.append(i),this.app.on(l("updateComplete"),(()=>{a()})),this.add()}},spillTheBeans:class extends b{constructor(t){super(t),this.title="Spill the beans",this.key=o(this.title),this.optional=!0;this.ui=e.create({tag:"details",text:[this.title,"summary"],classNames:this.isEnabled?[]:["inactive"]});const s=e.create({classNames:["pane"]});s.append(e.create({text:"Watch me while you type!",classNames:["spill-title"]}));const a=e.create({text:"ðŸ˜",classNames:["spill"]});s.append(a),this.ui.append(s),new MutationObserver((t=>{var e;a.textContent=(e=t.pop().target.textContent.trim())?h("remainders").filter((t=>t.startsWith(e))).length?"ðŸ™‚":"ðŸ™":"ðŸ˜"})).observe(e.$(".sb-hive-input-content",t.game),{childList:!0}),this.add()}},stepsToSuccess:class extends b{constructor(t){let s;super(t),this.title="Steps to success",this.key="stepsToSuccess",this.optional=!0;const a={},i=(t,i)=>{const n=u("answers");e.$$(".sb-modal-list li",t).forEach((t=>{const e=t.textContent.match(/([^\(]+) \((\d+)\)/);a[e[1]]=parseInt(e[2],10)})),a["Queen Bee"]=n,t.parentElement.style.opacity=0,e.$(".sb-modal-close",t).click(),s.disconnect(),r(i)},r=t=>{t.innerHTML="";const s=Object.values(a).filter((t=>t<=u("foundTerms"))).pop();for(const[i,r]of Object.entries(a))t.append(e.create({tag:"tr",classNames:r===s?["sba-current"]:[],cellTag:"td",cellData:[i,r]}))};this.ui=e.create({tag:"details",text:[this.title,"summary"],classNames:this.isEnabled?[]:["inactive"]});const n=e.create({tag:"table",classNames:["pane"]}),o=e.create({tag:"tbody"});n.append(o);const c=e.$(".sb-modal-buttons-section .pz-button__wrapper>button, sb-modal-close",e.$(".sb-modal-wrapper"));c&&c.click();const d=e.$(".sb-modal-wrapper");s=((t,s)=>{const a=new MutationObserver((a=>{const r=a.pop().target,n=e.$(".sb-modal-title",r);n&&"Rankings"===n.textContent.trim()&&(t.parentElement.style.opacity=0,i(t,s))}));return a.observe(t,{childList:!0}),a})(d,o),e.$(".sb-progress",t.game).click(),this.ui.append(n),t.on(l("updateComplete"),(()=>{r(o)})),this.add()}},surrender:class extends b{constructor(t){super(t),this.title="Surrender",this.key=o(this.title),this.optional=!0;let s=!1;const a=t=>!s&&(h("remainders").forEach((s=>{t.append((t=>{const s=e.create({tag:"li",classNames:h("pangrams").includes(t)?["sb-anagram","sb-pangram"]:["sb-anagram"]});return s.append(e.create({tag:"a",text:t,attributes:{href:`https://www.google.com/search?q=${t}`,target:"_blank"}})),s})(s))})),s=!0,!0);this.ui=e.create({tag:"details",text:[this.title,"summary"],classNames:this.isEnabled?[]:["inactive"]});const i=e.create({classNames:["pane"]});i.append(e.create({tag:"button",classNames:["hive-action"],text:"Display answers",attributes:{type:"button"},events:{click:function(){a(e.$(".sb-wordlist-items",this.app.game))}}})),this.ui.append(i),this.add()}},setUp:class extends b{constructor(t){super(t),this.title="Set-up",this.key=o(this.title),this.optional=!1;const s=e.create({tag:"ul",classNames:["pane"]});this.ui=e.create({tag:"details",text:[this.title,"summary"],events:{click:function(e){"INPUT"===e.target.tagName&&t.registry.get(e.target.name).toggle(e.target.checked)}}}),this.ui.append(s),(s=>{t.registry.forEach(((t,a)=>{if(!t.optional)return!1;const i=e.create({tag:"li"}),r=e.create({tag:"input",text:t.title,attributes:{type:"checkbox",name:a},checked:t.isEnabled()});i.append(r),s.append(i)}))})(s),this.add()}},footer:class extends b{constructor(t){super(t),this.title=`${i("label")} ${i("version")}`,this.key="footer",this.ui=e.create({tag:"a",text:this.title,attributes:{href:i("url"),target:"_blank"}}),this.add()}}};new class{constructor(t){if(!t||!window.gameData)return console.info(`This bookmarklet only works on ${i(targetUrl)}`),!1;this.title=i("label"),this.key=o(this.title),this.game=t;const s=e.$(`[data-id="${this.key}"]`);s&&s.dispatchEvent(new Event(l("destroy"))),this.registry=new Map,this.remove=()=>{this.ui.remove()},this.on=(t,e)=>{this.ui.addEventListener(t,e)},this.trigger=t=>{this.ui.dispatchEvent(t)};const a=e.$(".sb-content-box",t).getBoundingClientRect(),r=e.$(".sb-wordlist-items",t),n={};n[l("destroy")]=()=>{this.remove()},this.ui=e.create({attributes:{draggable:!0},style:{left:a.right+10+"px",top:a.top+window.pageYOffset+"px"},data:{id:this.key},classNames:[i("prefix")],events:n}),p(this,r),((t,e)=>{const s=new MutationObserver((e=>{t.on(new CustomEvent(l("update"),{detail:{text:e.pop().addedNodes[0]}}))}));s.observe(e,{childList:!0})})(this.ui,r),this.registerPlugins=t=>{for(const[e,s]of Object.entries(t))this.registry.set(e,new s(this))},e.$("body").append(this.ui)}}(e.$("#pz-game-root")).registerPlugins(f)}();
